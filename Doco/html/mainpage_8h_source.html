<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Alarm Cabinent: PIC Code/mainpage.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Alarm Cabinent</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">PIC Code/mainpage.h</div>  </div>
</div>
<div class="contents">
<a href="mainpage_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is a Doxygen file, not a part of the code.</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">/** @file mainpage.h</span>
<a name="l00004"></a>00004 <span class="comment">* @brief Alarm Cabinent Documentation page</span>
<a name="l00005"></a>00005 <span class="comment">* @mainpage Project overview</span>
<a name="l00006"></a>00006 <span class="comment">* </span>
<a name="l00007"></a>00007 <span class="comment">* This application has been developed to work with the microchip TCIP stack.</span>
<a name="l00008"></a>00008 <span class="comment">*  </span>
<a name="l00009"></a>00009 <span class="comment">* </span>
<a name="l00010"></a>00010 <span class="comment">* @section a1 xPL Framework </span>
<a name="l00011"></a>00011 <span class="comment">* </span>
<a name="l00012"></a>00012 <span class="comment">* The xPL framework provides the following feature:</span>
<a name="l00013"></a>00013 <span class="comment">* - Parsing all inbound xPL messages and converts them into a manageable data structure</span>
<a name="l00014"></a>00014 <span class="comment">* - Only passes relevant xPL messages to the device being implemented</span>
<a name="l00015"></a>00015 <span class="comment">* - Providing a consistent and easy method of transmitting all xPL messages</span>
<a name="l00016"></a>00016 <span class="comment">* - Handling all heart beat functionality</span>
<a name="l00017"></a>00017 <span class="comment">* - Greatly simplifying the device configuration process</span>
<a name="l00018"></a>00018 <span class="comment">* </span>
<a name="l00019"></a>00019 <span class="comment">* The device being implemented only needs to have the following methods exposed:</span>
<a name="l00020"></a>00020 <span class="comment">* - BOOL SchemaInit (void) - Returns true if the device has configuration, false sets the device into an un configured state</span>
<a name="l00021"></a>00021 <span class="comment">* - BOOL SchemaTasks (void) - Is called with each co operative multi tasking cycle, return True if a messages has been placed in the outbound queue</span>
<a name="l00022"></a>00022 <span class="comment">* - void SchemaProcessUDPMsg (void) - This is called by the xPL framework to process an inbound xPL message</span>
<a name="l00023"></a>00023 <span class="comment">* </span>
<a name="l00024"></a>00024 <span class="comment">* The xPL framework is initialised from the main.c file by opening a UDP socket, waiting for the network to stabilise and then calling the xPLInit() function. </span>
<a name="l00025"></a>00025 <span class="comment">* From main.c you call the StackTask() as a part of the TCPIP framework and maybe StackApplications(); if you are in the mood for running other services that are a part of</span>
<a name="l00026"></a>00026 <span class="comment">* the Microchip stack. After these functions are called then the xPL stack task is called.</span>
<a name="l00027"></a>00027 <span class="comment">* </span>
<a name="l00028"></a>00028 <span class="comment">\code</span>
<a name="l00029"></a>00029 <span class="comment">* void main(void) { </span>
<a name="l00030"></a>00030 <span class="comment">*       while(1) { </span>
<a name="l00031"></a>00031 <span class="comment">*               StackTask(); </span>
<a name="l00032"></a>00032 <span class="comment">*               StackApplications(); </span>
<a name="l00033"></a>00033 <span class="comment">*               XPLTasks(); </span>
<a name="l00034"></a>00034 <span class="comment">*       } </span>
<a name="l00035"></a>00035 <span class="comment">* } </span>
<a name="l00036"></a>00036 <span class="comment">* </span>
<a name="l00037"></a>00037 <span class="comment">\endcode </span>
<a name="l00038"></a>00038 <span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">Inside XPLTasks() there are 3 other tasks that need to run in this order, </span>
<a name="l00040"></a>00040 <span class="comment">* - Implemented schema related tasks - SchemaTasks()</span>
<a name="l00041"></a>00041 <span class="comment">* - UDP input buffer, for processing inbound messages</span>
<a name="l00042"></a>00042 <span class="comment">* - xPL heart beat message generation \n \n</span>
<a name="l00043"></a>00043 <span class="comment">Remember the Microchip TCP framework StackTask() needs to be called to flush the transmit buffer each time, hence only one can run per task run! The order is determined by importance, with the most important function being executed first.</span>
<a name="l00044"></a>00044 <span class="comment"> \n</span>
<a name="l00045"></a>00045 <span class="comment"> \n</span>
<a name="l00046"></a>00046 <span class="comment">* @section a2 Useful tools when implementing an xPL device:</span>
<a name="l00047"></a>00047 <span class="comment">* </span>
<a name="l00048"></a>00048 <span class="comment">- XPLSendHeader() \n</span>
<a name="l00049"></a>00049 <span class="comment"> Used to create any xPL message. Populates the header then adds class type and opens the body. \n</span>
<a name="l00050"></a>00050 <span class="comment"> </span>
<a name="l00051"></a>00051 <span class="comment">- xPLSaveEEConfig() \n</span>
<a name="l00052"></a>00052 <span class="comment"> Accepts configuration data (in the form of a pointer) and saves it to EE Prom.  Used in the SchemaInit() procedure.</span>
<a name="l00053"></a>00053 <span class="comment"> </span>
<a name="l00054"></a>00054 <span class="comment">- xPLLoadEEConfig() \n</span>
<a name="l00055"></a>00055 <span class="comment"> Loads data from EE Prom into the selected config pointer.  Used in the SchemaInit() procedure.</span>
<a name="l00056"></a>00056 <span class="comment"> </span>
<a name="l00057"></a>00057 <span class="comment">- SaveKVP() \n</span>
<a name="l00058"></a>00058 <span class="comment"> Loads a Key and a Value from the UDP message. Used in processing messages in SchemaProcessUDPMsg()</span>
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">- xPLFindArrayInKVP() \n</span>
<a name="l00061"></a>00061 <span class="comment"> Searches though an array looking for a match to TheValue. When a match is found  it will return the position in the array. Used in processing messages in SchemaProcessUDPMsg()</span>
<a name="l00062"></a>00062 <span class="comment">* </span>
<a name="l00063"></a>00063 <span class="comment"></span>
<a name="l00064"></a>00064 <span class="comment">@section a3 Security </span>
<a name="l00065"></a>00065 <span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">Functions of the secrutiy schema are called via three entry points \n</span>
<a name="l00067"></a>00067 <span class="comment">1) HTTPExecuteGet(), the result of posting data on the HTTP form. \n</span>
<a name="l00068"></a>00068 <span class="comment">2) SchemaProcessUDPMsg(), receiving xPL data. \n</span>
<a name="l00069"></a>00069 <span class="comment">3) SchemaTasks(), xPL framework calling the secuirty_system.c task function\n</span>
<a name="l00070"></a>00070 <span class="comment"></span>
<a name="l00071"></a>00071 <span class="comment">When sending an xPL message, it is placed into xPLTaskList where the function SchemaTasks() then excitues the fuction once a UDP socket is available.</span>
<a name="l00072"></a>00072 <span class="comment">The same function decides when to check the input pins for changes in the alarm sensore, IOTasks() and battery related function BatteryTask().</span>
<a name="l00073"></a>00073 <span class="comment"></span>
<a name="l00074"></a>00074 <span class="comment">Data Structure: \n</span>
<a name="l00075"></a>00075 <span class="comment">xPLConfigs is all of the confiration data for the device. This data is saved and loaded out of the EE Prom \n</span>
<a name="l00076"></a>00076 <span class="comment">AreaConfigs and  ZoneConfigs hold tempery state information on individual areas and zones. \n</span>
<a name="l00077"></a>00077 <span class="comment"></span>
<a name="l00078"></a>00078 <span class="comment"></span>
<a name="l00079"></a>00079 <span class="comment"></span>
<a name="l00080"></a>00080 <span class="comment">*/</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Apr 25 2011 23:31:09 for Alarm Cabinent by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
