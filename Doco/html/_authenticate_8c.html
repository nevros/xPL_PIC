<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Alarm Cabinent: PIC Code/Authenticate.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Alarm Cabinent</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">PIC Code/Authenticate.c File Reference</div>  </div>
</div>
<div class="contents">

<p>Authenication, xPL and web.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_a_e_s_8h_source.html">AES.h</a>&quot;</code><br/>
<code>#include &quot;TCPIP Stack/TCPIP.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="x_p_l_8h_source.html">xPL.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_security_system_8h_source.html">SecuritySystem.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Authenticate.c:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c__incl.svg" width="779" height="150" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="_authenticate_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>&#160;&#160;&#160;16</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a85c957755e126e87ba42b9536489a44c">MAXTIMEDIFFERENCE</a>&#160;&#160;&#160;120</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#ad9ccab53e1332706a0181ea3d79c6ee6">LoadUserNameEEdata</a> (BYTE *p, int UserNumber)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#ae2103408fea706307404b433f103eb56">LoadUserPasswordEEdata</a> (BYTE *p, int UserNumber, int ReturnLength, int StartPosition)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a3a54eb2d8295163334f74dbacc0784e1">SaveUserPasswordEEdata</a> (BYTE *p, int UserNumber)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a0be112c6d3c0c4852d7b5d78c30006a2">SaveUserNameEEdata</a> (BYTE *p, int UserNumber)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a207b19b2185ffaa19d1d3f053b996121">xPLAuthenticate</a> (char *Password)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#accacf14baedf98bbdcea140a8f3cd3eb">Authenticate</a> (char *Password)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a4f5402c5a9df50f4adaf8f2e3d393344">HTTPPrint_RejectPassword</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a4d625f0ecf98464870350caed696c3ca">HTTPPrint_UserName</a> (WORD num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#af7da7701f182ba72027f320fbc33add7">HTTPPrint_UserPassword</a> (WORD num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a73d4e378556fa6a028b9460759871f2c">ModifyUser</a> (BYTE *ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BYTE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a6ba849dc7abd3ee3c07e53b0fdbbd202">HTTPNeedsAuth</a> (BYTE *cFile)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BYTE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a1d92bb5a4818d19c7b16c60ec6cc96f4">HTTPCheckAuth</a> (BYTE *cUser, BYTE *cPass)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#af2f1f5bbb93bdf9f28c0ca42b847e6dd">HTTPPrint_PrintEEProm</a> (WORD num)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_authenticate_8c.html#a3b83b71efc87ba66b8d8311363b4296e">RejectedPassword</a> [USERPASSLENGTH]</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Tracks that last password that was rejected, useful when adding RFID tags.  <a href="#a3b83b71efc87ba66b8d8311363b4296e"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Authenication, xPL and web. </p>

<p>Definition in file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a04cbe46ec8c2a3acc05ba721f005f62c"></a><!-- doxytag: member="Authenticate.c::AESBLOCKSIZE" ref="a04cbe46ec8c2a3acc05ba721f005f62c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AESBLOCKSIZE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00009">9</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00039">xPLAuthenticate()</a>.</p>

</div>
</div>
<a class="anchor" id="a85c957755e126e87ba42b9536489a44c"></a><!-- doxytag: member="Authenticate.c::MAXTIMEDIFFERENCE" ref="a85c957755e126e87ba42b9536489a44c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXTIMEDIFFERENCE&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00010">10</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00039">xPLAuthenticate()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="accacf14baedf98bbdcea140a8f3cd3eb"></a><!-- doxytag: member="Authenticate.c::Authenticate" ref="accacf14baedf98bbdcea140a8f3cd3eb" args="(char *Password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL Authenticate </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Password</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Authenticates the user by checking the password. Populates the users name into UserID. Return TRUE if the user was found. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>add config option to reject users from different subnet </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">Password</td><td>char </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>BOOL if authentication worked. global of UserID is also updated in the process </dd></dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00188">188</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="x_p_l_8h_source.html#l00004">FALSE</a>, <a class="el" href="_security_system_8c_source.html#l00035">iCount</a>, <a class="el" href="_authenticate_8c_source.html#l00369">LoadUserNameEEdata()</a>, <a class="el" href="_authenticate_8c_source.html#l00333">LoadUserPasswordEEdata()</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="x_p_l_8h_source.html#l00005">TRUE</a>, <a class="el" href="_security_system_8h_source.html#l00011">USERCOUNT</a>, <a class="el" href="_security_system_8c_source.html#l00037">UserID</a>, <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>, and <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00039">xPLAuthenticate()</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
        
    <span class="keywordtype">char</span> UserPassword[<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>+1];        
        memset(<a class="code" href="_security_system_8c.html#af1c18f7532835833de15218c3aa5d146" title="Name of user.">UserID</a>, <span class="charliteral">&#39;\0&#39;</span>,<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>);
        
        <span class="comment">// ensure we have something in the password to check.</span>
        <span class="keywordflow">if</span> (*Password == <span class="charliteral">&#39;\0&#39;</span>) {
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; INVALID, FAILED authentication\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
        }
        
        
        <span class="comment">// Override password</span>
        <span class="keywordflow">if</span> (!strcmppgm2ram((<span class="keywordtype">char</span>*)Password, (ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;boo&quot;</span>)) {
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Override password used\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                strcpypgm2ram((<span class="keywordtype">char</span>*)<a class="code" href="_security_system_8c.html#af1c18f7532835833de15218c3aa5d146" title="Name of user.">UserID</a>, (ROM <span class="keywordtype">void</span>*)<span class="stringliteral">&quot;Boo&quot;</span>);
                <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
        }       
        
        
        
        <span class="keywordflow">for</span>(<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> = 0; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> &lt; <a class="code" href="_security_system_8h.html#a330ed48a0698997047c61969a5245074">USERCOUNT</a>; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>++) {
            <span class="comment">// cycle through all of the passwords until we find it</span>
            <a class="code" href="_authenticate_8c.html#ae2103408fea706307404b433f103eb56">LoadUserPasswordEEdata</a> ((BYTE *) UserPassword, <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>, <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>, 0);
            <span class="keywordflow">if</span> (!strcmp((<span class="keywordtype">char</span>*)Password, UserPassword)) {
                    <a class="code" href="_authenticate_8c.html#ad9ccab53e1332706a0181ea3d79c6ee6">LoadUserNameEEdata</a> (<a class="code" href="_security_system_8c.html#af1c18f7532835833de15218c3aa5d146" title="Name of user.">UserID</a>, <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>);
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; User:&quot;</span>);
                        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(<a class="code" href="_security_system_8c.html#af1c18f7532835833de15218c3aa5d146" title="Name of user.">UserID</a>);
                        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; has passed authentication\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                    <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
                        <span class="keywordflow">break</span>;
                }<span class="comment">// UserName</span>
        }<span class="comment">// iCount</span>
        
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; User:&quot;</span>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(Password);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; has FAILED authentication\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        
        <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
        
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_accacf14baedf98bbdcea140a8f3cd3eb_cgraph.svg" width="536" height="126" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_accacf14baedf98bbdcea140a8f3cd3eb_icgraph.svg" width="1419" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1d92bb5a4818d19c7b16c60ec6cc96f4"></a><!-- doxytag: member="Authenticate.c::HTTPCheckAuth" ref="a1d92bb5a4818d19c7b16c60ec6cc96f4" args="(BYTE *cUser, BYTE *cPass)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BYTE HTTPCheckAuth </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>cUser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>cPass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00592">592</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>, <a class="el" href="_security_system_8h_source.html#l00048">HTTP_AUTH_ADMIN</a>, <a class="el" href="_security_system_8c_source.html#l00035">iCount</a>, <a class="el" href="_authenticate_8c_source.html#l00369">LoadUserNameEEdata()</a>, <a class="el" href="_authenticate_8c_source.html#l00333">LoadUserPasswordEEdata()</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_security_system_8h_source.html#l00011">USERCOUNT</a>, and <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>.</p>
<div class="fragment"><pre class="fragment">                                             {
        
    <span class="keywordtype">char</span> UserPassword[<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>+1];
    <span class="keywordtype">char</span> UserName[<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>+1];
    
    <span class="keywordflow">if</span> (!strcmppgm2ram((<span class="keywordtype">char</span>*)cPass, (ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;boo&quot;</span>)) {
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Web Override password used\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="keywordflow">return</span> 0xff;
    }   
        
    <span class="comment">// Check if admin access is required</span>
    <span class="keywordflow">if</span>(<a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.isAuthorized == <a class="code" href="_security_system_8h.html#acb2785015a18eb21dd25b93b9b565f5f">HTTP_AUTH_ADMIN</a>) {
                memset(UserPassword, <span class="charliteral">&#39;\0&#39;</span>,  <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>);
                <a class="code" href="_authenticate_8c.html#ae2103408fea706307404b433f103eb56">LoadUserPasswordEEdata</a> ((BYTE *) UserPassword, 0, <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>, 0);
                <a class="code" href="_authenticate_8c.html#ad9ccab53e1332706a0181ea3d79c6ee6">LoadUserNameEEdata</a> (UserName, 0);
                <span class="keywordflow">if</span> ( (!strcmp((<span class="keywordtype">char</span>*)cUser, UserName)) &amp;&amp;
                (!strcmp((<span class="keywordtype">char</span>*)cPass, UserPassword)) ) {
                        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Web Admin user accpeted\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        <span class="keywordflow">return</span> 0xff;
                }
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Web Admin password rejected\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span> 0x00;
        }<span class="comment">// HTTP_AUTH_ADMIN</span>
        
    <span class="keywordflow">else</span> {
                <span class="keywordflow">for</span>(<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> = 0; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> &lt; <a class="code" href="_security_system_8h.html#a330ed48a0698997047c61969a5245074">USERCOUNT</a>; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>++) {
                    <a class="code" href="_authenticate_8c.html#ad9ccab53e1332706a0181ea3d79c6ee6">LoadUserNameEEdata</a> (UserName, <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>);
                    <span class="keywordflow">if</span> (!strcmp((<span class="keywordtype">char</span>*)cUser, UserName)) {
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Web User name accepted,looking for password&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                            <a class="code" href="_authenticate_8c.html#ae2103408fea706307404b433f103eb56">LoadUserPasswordEEdata</a> ((BYTE *) UserPassword, <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>, <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>, 0);
                            <span class="keywordflow">if</span> (!strcmp((<span class="keywordtype">char</span>*)cPass, UserPassword)) {
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                                        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; Accepted\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                                        <span class="keywordflow">return</span> 0x80;
                                }
                        }<span class="comment">// UserName</span>
                }<span class="comment">// iCount</span>
            
        } <span class="comment">// isAuthorized</span>
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; rejected\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
    <span class="keywordflow">return</span> 0x00;
    
        
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a1d92bb5a4818d19c7b16c60ec6cc96f4_cgraph.svg" width="563" height="126" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6ba849dc7abd3ee3c07e53b0fdbbd202"></a><!-- doxytag: member="Authenticate.c::HTTPNeedsAuth" ref="a6ba849dc7abd3ee3c07e53b0fdbbd202" args="(BYTE *cFile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BYTE HTTPNeedsAuth </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>cFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00556">556</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_security_system_8h_source.html#l00048">HTTP_AUTH_ADMIN</a>, <a class="el" href="_security_system_8h_source.html#l00049">HTTP_AUTH_OTHER</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, and <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>.</p>
<div class="fragment"><pre class="fragment">                                {
        
    <span class="comment">// Don&#39;t use strcmp here, because cFile has additional path info</span>
    
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Web page being loaded:&quot;</span>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(cFile);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    
    <span class="comment">// All pages that need admin access are stored in the file call admin</span>
    <span class="keywordflow">if</span>(!memcmppgm2ram((<span class="keywordtype">void</span>*)cFile, (ROM <span class="keywordtype">void</span>*)<span class="stringliteral">&quot;admin&quot;</span>, 5)) {
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; Page needs admin access\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span> <a class="code" href="_security_system_8h.html#acb2785015a18eb21dd25b93b9b565f5f">HTTP_AUTH_ADMIN</a>;
        }    
    
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; Page needs general access\r\n&quot;</span>); 
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="_security_system_8h.html#aeb3aff1f96e2e5351d1c4c31ef870696">HTTP_AUTH_OTHER</a>;
        
        
}  <span class="comment">//HTTPNeedsAuth</span>
</pre></div>
</div>
</div>
<a class="anchor" id="af2f1f5bbb93bdf9f28c0ca42b847e6dd"></a><!-- doxytag: member="Authenticate.c::HTTPPrint_PrintEEProm" ref="af2f1f5bbb93bdf9f28c0ca42b847e6dd" args="(WORD num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HTTPPrint_PrintEEProm </td>
          <td>(</td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>num</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is a debug function that will print the entire contents of the EEdata to a web page. Handy when you can not figure what the hell is going on ;) </p>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00658">658</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>, <a class="el" href="x_p_l_8c_source.html#l00016">xPLMsgValue</a>, and <a class="el" href="x_p_l_8h_source.html#l00023">xPLMSGVALUELENGTH</a>.</p>
<div class="fragment"><pre class="fragment">                                     {
        
        <span class="comment">// Set a flag to indicate not finished</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 1;
        
        <span class="comment">// Make sure there&#39;s enough output space</span>
        <span class="keywordflow">if</span>(TCPIsPutReady(sktHTTP) &lt; 50)
                <span class="keywordflow">return</span>;
    
    memset (<a class="code" href="x_p_l_8c.html#a65d6c76d15acf1f33b1d8778f79881db" title="Used as a temp storage for processing messages, holds the value of a key value pair.">xPLMsgValue</a>, <span class="charliteral">&#39;\0&#39;</span>, <a class="code" href="x_p_l_8h.html#aae5a87b8c5b796965aa8548462ed8f39">xPLMSGVALUELENGTH</a>);
    
    XEEReadArray ((DWORD) num, <a class="code" href="x_p_l_8c.html#a65d6c76d15acf1f33b1d8778f79881db" title="Used as a temp storage for processing messages, holds the value of a key value pair.">xPLMsgValue</a> , (BYTE) 50); 
    
    TCPPutArray(sktHTTP, <a class="code" href="x_p_l_8c.html#a65d6c76d15acf1f33b1d8778f79881db" title="Used as a temp storage for processing messages, holds the value of a key value pair.">xPLMsgValue</a>, 50);
    
    <span class="comment">// Indicate that we&#39;re done</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 0x00;
        <span class="keywordflow">return</span>;
        
        
}<span class="comment">//HTTPPrint_UserName</span>
</pre></div>
</div>
</div>
<a class="anchor" id="a4f5402c5a9df50f4adaf8f2e3d393344"></a><!-- doxytag: member="Authenticate.c::HTTPPrint_RejectPassword" ref="a4f5402c5a9df50f4adaf8f2e3d393344" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HTTPPrint_RejectPassword </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dynamic variable that prints the user password that was last rejected </p>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00246">246</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>, <a class="el" href="_authenticate_8c_source.html#l00017">RejectedPassword</a>, and <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
        
        <span class="comment">// Set a flag to indicate not finished</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 1;
        
        <span class="comment">// Make sure there&#39;s enough output space</span>
        <span class="keywordflow">if</span>(TCPIsPutReady(sktHTTP) &lt; <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>)
                <span class="keywordflow">return</span>;
    
    TCPPutArray(sktHTTP, <a class="code" href="_authenticate_8c.html#a3b83b71efc87ba66b8d8311363b4296e" title="Tracks that last password that was rejected, useful when adding RFID tags.">RejectedPassword</a>, <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>);
    
    <span class="comment">// Indicate that we&#39;re done</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 0x00;
        <span class="keywordflow">return</span>;
        
        
        
}<span class="comment">//HTTPPrint_UserName</span>
</pre></div>
</div>
</div>
<a class="anchor" id="a4d625f0ecf98464870350caed696c3ca"></a><!-- doxytag: member="Authenticate.c::HTTPPrint_UserName" ref="a4d625f0ecf98464870350caed696c3ca" args="(WORD num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HTTPPrint_UserName </td>
          <td>(</td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>num</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dynamic variable that prints the user name to the web page </p>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00271">271</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>, <a class="el" href="_authenticate_8c_source.html#l00369">LoadUserNameEEdata()</a>, and <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>.</p>
<div class="fragment"><pre class="fragment">                                  {
        
        <span class="keywordtype">char</span> UserName[<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>+1];
    
    UserName[<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>] = <span class="charliteral">&#39;\0&#39;</span>;
    
    <span class="comment">// Set a flag to indicate not finished</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 1;
        
        <span class="comment">// Make sure there&#39;s enough output space</span>
        <span class="keywordflow">if</span>(TCPIsPutReady(sktHTTP) &lt; <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>)
                <span class="keywordflow">return</span>;
    
    <a class="code" href="_authenticate_8c.html#ad9ccab53e1332706a0181ea3d79c6ee6">LoadUserNameEEdata</a> ((BYTE *)UserName, num) ; 
    
    TCPPutArray(sktHTTP, UserName, strlen(UserName));
    
    <span class="comment">// Indicate that we&#39;re done</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 0x00;
        <span class="keywordflow">return</span>;
        
        
}<span class="comment">//HTTPPrint_UserName</span>
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a4d625f0ecf98464870350caed696c3ca_cgraph.svg" width="560" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af7da7701f182ba72027f320fbc33add7"></a><!-- doxytag: member="Authenticate.c::HTTPPrint_UserPassword" ref="af7da7701f182ba72027f320fbc33add7" args="(WORD num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HTTPPrint_UserPassword </td>
          <td>(</td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>num</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dynamic variable that prints the user password to the web page </p>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00300">300</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>, <a class="el" href="_authenticate_8c_source.html#l00333">LoadUserPasswordEEdata()</a>, and <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>.</p>
<div class="fragment"><pre class="fragment">                                      {
        
    <span class="keywordtype">char</span> UserPassword[<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>+1];
    
    UserPassword[<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>] = <span class="charliteral">&#39;\0&#39;</span>;
    
    <span class="comment">// Set a flag to indicate not finished</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 1;
        
        <span class="comment">// Make sure there&#39;s enough output space</span>
        <span class="keywordflow">if</span>(TCPIsPutReady(sktHTTP) &lt; <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>)
                <span class="keywordflow">return</span>;
    
    <a class="code" href="_authenticate_8c.html#ae2103408fea706307404b433f103eb56">LoadUserPasswordEEdata</a> ((BYTE *)UserPassword, num,<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>, 0) ;
    
    TCPPutArray(sktHTTP, UserPassword, strlen(UserPassword));
    
    <span class="comment">// Indicate that we&#39;re done</span>
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.callbackPos = 0x00;
        <span class="keywordflow">return</span>;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_af7da7701f182ba72027f320fbc33add7_cgraph.svg" width="638" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad9ccab53e1332706a0181ea3d79c6ee6"></a><!-- doxytag: member="Authenticate.c::LoadUserNameEEdata" ref="ad9ccab53e1332706a0181ea3d79c6ee6" args="(BYTE *p, int UserNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LoadUserNameEEdata </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>UserNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>P R I V A T E P R O T O T Y P E S</p>
<p>Takes the user number and loads the name of that user into the pointer Note, It will read the full size of the feild.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">*p,output</td><td>feed into this pointer </td></tr>
    <tr><td class="paramname">UserNumber,user</td><td>number to be outputed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00369">369</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_security_system_8h_source.html#l00043">EEDATASTART_USER</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="_security_system_8h_source.html#l00011">USERCOUNT</a>, <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>, and <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00188">Authenticate()</a>, <a class="el" href="_authenticate_8c_source.html#l00592">HTTPCheckAuth()</a>, and <a class="el" href="_authenticate_8c_source.html#l00271">HTTPPrint_UserName()</a>.</p>
<div class="fragment"><pre class="fragment">                                                  {
        
        <span class="keywordtype">int</span> StartAddress;
        <span class="keywordtype">char</span> DebugOutput[3];
        
        <span class="comment">// make sure request is not out of range</span>
        <span class="keywordflow">if</span> (UserNumber &gt;= <a class="code" href="_security_system_8h.html#a330ed48a0698997047c61969a5245074">USERCOUNT</a>) {
                *p = <span class="charliteral">&#39;\0&#39;</span>;
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;User ID:&quot;</span>);
                uitoa(UserNumber,  DebugOutput);
                <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(DebugOutput);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;\r\n&quot;</span>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;#ERROR# User out of range,LoadUserNameEEdata \r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span>;
        }       
        
        <span class="comment">// find the begining of the users password</span>
    StartAddress = (<span class="keywordtype">unsigned</span> int) <a class="code" href="_security_system_8h.html#a1d0791661020cc7057f1ed794a848f20">EEDATASTART_USER</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) ((<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a> + <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>) * UserNumber);
    
    XEEReadArray ((DWORD) StartAddress, p , (BYTE) <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>); 
        
        
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_ad9ccab53e1332706a0181ea3d79c6ee6_icgraph.svg" width="1830" height="192" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae2103408fea706307404b433f103eb56"></a><!-- doxytag: member="Authenticate.c::LoadUserPasswordEEdata" ref="ae2103408fea706307404b433f103eb56" args="(BYTE *p, int UserNumber, int ReturnLength, int StartPosition)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LoadUserPasswordEEdata </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>UserNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ReturnLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>StartPosition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Takes the user number and loads the password of that user into the pointer. The length can be limited for easy use in HTTPPrint </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">*p,updates</td><td>pointer with the output </td></tr>
    <tr><td class="paramname">UserNumber,the</td><td>user number to return </td></tr>
    <tr><td class="paramname">ReturnLength,the</td><td>number of characters to return </td></tr>
    <tr><td class="paramname">StartPosition,start</td><td>returning characters after this position </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Null, returns values with *p </dd></dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00333">333</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_security_system_8h_source.html#l00043">EEDATASTART_USER</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="_security_system_8h_source.html#l00011">USERCOUNT</a>, <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>, <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>, and <a class="el" href="x_p_l_8c_source.html#l00014">xPLMsgKey</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00188">Authenticate()</a>, <a class="el" href="_authenticate_8c_source.html#l00592">HTTPCheckAuth()</a>, <a class="el" href="_authenticate_8c_source.html#l00300">HTTPPrint_UserPassword()</a>, and <a class="el" href="_authenticate_8c_source.html#l00039">xPLAuthenticate()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                           {
        
        <span class="keywordtype">int</span> StartAddress;
        
        <span class="comment">// make sure request is not out of range</span>
        <span class="keywordflow">if</span> (UserNumber &gt;= <a class="code" href="_security_system_8h.html#a330ed48a0698997047c61969a5245074">USERCOUNT</a>) {
                *p = <span class="charliteral">&#39;\0&#39;</span>;
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;User ID:&quot;</span>);
                uitoa(UserNumber,  <a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
                <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(<a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;\r\n&quot;</span>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;#ERROR# User out of range,LoadUserPasswordEEdata \r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span>;
        }       
        
        <span class="comment">// find the begining of the users password</span>
    StartAddress = (<span class="keywordtype">unsigned</span> int) <a class="code" href="_security_system_8h.html#a1d0791661020cc7057f1ed794a848f20">EEDATASTART_USER</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) (((<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a> + <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>) * UserNumber) + <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>);
    StartAddress += StartPosition;
        
        
        XEEReadArray ((DWORD) StartAddress, p , (BYTE) ReturnLength); 
        
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_ae2103408fea706307404b433f103eb56_icgraph.svg" width="1907" height="243" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a73d4e378556fa6a028b9460759871f2c"></a><!-- doxytag: member="Authenticate.c::ModifyUser" ref="a73d4e378556fa6a028b9460759871f2c" args="(BYTE *ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ModifyUser </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>HTTP GET from the user admin web page, this updates the Name and Password of the user in EE prom </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">*ptr,from</td><td>HTTP (GET) stack </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00487">487</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>, <a class="el" href="_h_t_t_p_forms_8c_source.html#l00542">DecodeIntFromGET()</a>, <a class="el" href="_security_system_8c_source.html#l00035">iCount</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="_authenticate_8c_source.html#l00447">SaveUserNameEEdata()</a>, <a class="el" href="_authenticate_8c_source.html#l00403">SaveUserPasswordEEdata()</a>, <a class="el" href="_security_system_8c_source.html#l00037">UserID</a>, <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>, <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>, and <a class="el" href="x_p_l_8c_source.html#l00014">xPLMsgKey</a>.</p>

<p>Referenced by <a class="el" href="_h_t_t_p_forms_8c_source.html#l00028">HTTPExecuteGet()</a>.</p>
<div class="fragment"><pre class="fragment">                            {
        
        <span class="keywordtype">int</span> <a class="code" href="_security_system_8c.html#af1c18f7532835833de15218c3aa5d146" title="Name of user.">UserID</a>, <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>;
        <span class="keywordtype">char</span> NewUserName[<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>+1];
        <span class="keywordtype">char</span> NewUserPassword[<a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>+1];
        
        <span class="comment">// clear out the memory just in case</span>
        memset (NewUserName, <span class="charliteral">&#39;\0&#39;</span>, <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>+1);
        memset (NewUserPassword, <span class="charliteral">&#39;\0&#39;</span>, <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>+1);
        
        <span class="comment">//ID of the user being updated</span>
        ptr = HTTPGetROMArg(<a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.data, (ROM BYTE *)<span class="stringliteral">&quot;id&quot;</span>);
        <span class="keywordflow">if</span>(*ptr) 
                UserID = <a class="code" href="_h_t_t_p_forms_8c.html#a6e8f2eab6326e5e8d0884ac0f3329628" title="Decodes and int value from a HTTP buffer (GET)">DecodeIntFromGET</a>(ptr,  (rom <span class="keywordtype">char</span> *)<span class="stringliteral">&quot;User ID&quot;</span>);
        
        <span class="comment">// User Name</span>
        ptr = HTTPGetROMArg(<a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.data, (ROM BYTE *)<span class="stringliteral">&quot;N&quot;</span>);
        <span class="keywordflow">if</span>(*ptr) {
                <span class="keywordflow">for</span>(iCount = 0;iCount &lt; <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>; iCount++) {
                        NewUserName[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>] = *ptr;
                        <span class="keywordflow">if</span> (*ptr != <span class="charliteral">&#39;\0&#39;</span>) ptr++;
                }<span class="comment">// for </span>
        }
        
        <span class="comment">// User Password</span>
        ptr = HTTPGetROMArg(<a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.data, (ROM BYTE *)<span class="stringliteral">&quot;P&quot;</span>);
        <span class="keywordflow">if</span>(*ptr) {
                <span class="keywordflow">for</span>(iCount = 0;iCount &lt; <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>; iCount++) {
                        NewUserPassword[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>] = *ptr;
                        <span class="comment">//if (*ptr != &#39;\0&#39;) </span>
                        ptr++;
                }<span class="comment">// for </span>
        }
        
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;NewUserName:&quot;</span>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(NewUserName);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; strlen:&quot;</span>);
        uitoa(strlen(NewUserName),  <a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(<a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);            
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; : &quot;</span>);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;NewUserPassword:&quot;</span>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(NewUserPassword);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; strlen:&quot;</span>);
        uitoa(strlen(NewUserPassword),  <a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(<a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;\r\n&quot;</span>);
        
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <a class="code" href="_authenticate_8c.html#a0be112c6d3c0c4852d7b5d78c30006a2">SaveUserNameEEdata</a> (NewUserName, UserID) ;
        
        <a class="code" href="_authenticate_8c.html#a3a54eb2d8295163334f74dbacc0784e1">SaveUserPasswordEEdata</a> (NewUserPassword, UserID) ;
        
        strcpypgm2ram((<span class="keywordtype">char</span>*)<a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.data, (ROM <span class="keywordtype">void</span>*)<span class="stringliteral">&quot;/admin/users.htm&quot;</span>);
        <a class="code" href="_h_t_t_p_variables_8c.html#a56dd5313e3ef1f8da6a1a98c9457eac1">curHTTP</a>.httpStatus = HTTP_REDIRECT;                     
        
        
        
} <span class="comment">//ModifyUser</span>
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a73d4e378556fa6a028b9460759871f2c_cgraph.svg" width="523" height="192" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a73d4e378556fa6a028b9460759871f2c_icgraph.svg" width="411" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0be112c6d3c0c4852d7b5d78c30006a2"></a><!-- doxytag: member="Authenticate.c::SaveUserNameEEdata" ref="a0be112c6d3c0c4852d7b5d78c30006a2" args="(BYTE *p, int UserNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SaveUserNameEEdata </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>UserNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Saves the data stored in the pointer into the name feild of the user held in EE prom. Note, It will write the full size of the feild. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">*p,name</td><td>to be saved </td></tr>
    <tr><td class="paramname">UserNumber,user</td><td>number to save data to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00447">447</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_security_system_8h_source.html#l00043">EEDATASTART_USER</a>, <a class="el" href="_security_system_8c_source.html#l00035">iCount</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="_security_system_8h_source.html#l00011">USERCOUNT</a>, <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>, <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>, and <a class="el" href="x_p_l_8c_source.html#l00014">xPLMsgKey</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00487">ModifyUser()</a>.</p>
<div class="fragment"><pre class="fragment">                                                  {
        
        <span class="keywordtype">int</span> StartAddress;
        
        <span class="comment">// make sure request is not out of range</span>
        <span class="keywordflow">if</span> (UserNumber &gt;= <a class="code" href="_security_system_8h.html#a330ed48a0698997047c61969a5245074">USERCOUNT</a>) {
                *p = <span class="charliteral">&#39;\0&#39;</span>;
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;User ID:&quot;</span>);
                uitoa(UserNumber,  <a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
                <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(<a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;\r\n&quot;</span>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;#ERROR# User out of range,SaveUserPasswordEEdata \r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span>;
        }       
        
        <span class="comment">// find the begining of the users password</span>
    StartAddress = (<span class="keywordtype">unsigned</span> int) <a class="code" href="_security_system_8h.html#a1d0791661020cc7057f1ed794a848f20">EEDATASTART_USER</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) ((<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a> + <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>) * UserNumber);
    
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Saving user name\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <span class="keywordflow">for</span>(<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> = 0; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> &lt; <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>++) {
                <span class="comment">//      if(XEEBeginWrite(StartAddress + iCount) != XEE_SUCCESS )</span>
                XEEBeginWrite(StartAddress + <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>);
                XEEWrite(p[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>]);
                XEEEndWrite();
                <span class="keywordflow">while</span>(XEEIsBusy());             
        }
        
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a0be112c6d3c0c4852d7b5d78c30006a2_icgraph.svg" width="704" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3a54eb2d8295163334f74dbacc0784e1"></a><!-- doxytag: member="Authenticate.c::SaveUserPasswordEEdata" ref="a3a54eb2d8295163334f74dbacc0784e1" args="(BYTE *p, int UserNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SaveUserPasswordEEdata </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>UserNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Saves the data stored in the pointer into the password feild of the user held in EE prom Note, It will write the full size of the feild. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">*p,data</td><td>to be saved </td></tr>
    <tr><td class="paramname">UserNumber,user</td><td>number to save data to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00403">403</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_security_system_8h_source.html#l00043">EEDATASTART_USER</a>, <a class="el" href="_security_system_8c_source.html#l00035">iCount</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="_security_system_8h_source.html#l00011">USERCOUNT</a>, <a class="el" href="_security_system_8h_source.html#l00009">USERNAMELENGTH</a>, <a class="el" href="_security_system_8h_source.html#l00010">USERPASSLENGTH</a>, and <a class="el" href="x_p_l_8c_source.html#l00014">xPLMsgKey</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00487">ModifyUser()</a>.</p>
<div class="fragment"><pre class="fragment">                                                      {
        
        <span class="keywordtype">int</span> StartAddress;
        
        <span class="comment">// make sure request is not out of range</span>
        <span class="keywordflow">if</span> (UserNumber &gt;= <a class="code" href="_security_system_8h.html#a330ed48a0698997047c61969a5245074">USERCOUNT</a>) {
                *p = <span class="charliteral">&#39;\0&#39;</span>;
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;User ID:&quot;</span>);
                uitoa(UserNumber,  <a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
                <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(<a class="code" href="x_p_l_8c.html#ab1bd647d7b5e8841a1378eedabb62c2e" title="Security, were most of it is at.">xPLMsgKey</a>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;\r\n&quot;</span>);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;#ERROR# User out of range,SaveUserPasswordEEdata \r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                <span class="keywordflow">return</span>;
        }       
        
        <span class="comment">// find the begining of the users password</span>
    StartAddress = (<span class="keywordtype">unsigned</span> int) <a class="code" href="_security_system_8h.html#a1d0791661020cc7057f1ed794a848f20">EEDATASTART_USER</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) (((<a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a> + <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>) * UserNumber) + <a class="code" href="_security_system_8h.html#ab2d5f95a4974c4f332df9f6a41022219">USERNAMELENGTH</a>);
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Saving user password\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        
        <span class="keywordflow">for</span>(<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> = 0; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> &lt; <a class="code" href="_security_system_8h.html#abbe086a1e768641e6894ec5116a52ae9">USERPASSLENGTH</a>; <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>++) {
                <span class="comment">//if(XEEBeginWrite(StartAddress + iCount) != XEE_SUCCESS )      </span>
                XEEBeginWrite(StartAddress + <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>); 
                XEEWrite(p[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>]);
                XEEEndWrite();
                <span class="keywordflow">while</span>(XEEIsBusy());             
        }
        
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a3a54eb2d8295163334f74dbacc0784e1_icgraph.svg" width="736" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a207b19b2185ffaa19d1d3f053b996121"></a><!-- doxytag: member="Authenticate.c::xPLAuthenticate" ref="a207b19b2185ffaa19d1d3f053b996121" args="(char *Password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL xPLAuthenticate </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Password</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called when receiving an xPL message that contains a user that needs to be checked. Authenticates the user by decoding the message (if AES enabled) and then calls <a class="el" href="_authenticate_8c.html#accacf14baedf98bbdcea140a8f3cd3eb">Authenticate()</a>; to check if this is a valid user. Return TRUE if the user was found and updates the UserID variable with the user name.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">Password</td><td>char, the supplied password </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>BOOL if authentication worked. global of UserID is also updated in the process </dd></dl>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00039">39</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>References <a class="el" href="_security_x_p_l_sender_8c_source.html#l00017">addxPLMessage()</a>, <a class="el" href="_authenticate_8c_source.html#l00009">AESBLOCKSIZE</a>, <a class="el" href="_a_e_s_8c_source.html#l00432">AESCalcDecodeKey()</a>, <a class="el" href="_a_e_s_8c_source.html#l00464">AESDecode()</a>, <a class="el" href="_authenticate_8c_source.html#l00188">Authenticate()</a>, <a class="el" href="x_p_l_8h_source.html#l00004">FALSE</a>, <a class="el" href="_security_system_8c_source.html#l00035">iCount</a>, <a class="el" href="_authenticate_8c_source.html#l00333">LoadUserPasswordEEdata()</a>, <a class="el" href="_authenticate_8c_source.html#l00010">MAXTIMEDIFFERENCE</a>, <a class="el" href="_hardware_profile_8h_source.html#l00204">putrsUART</a>, <a class="el" href="_hardware_profile_8h_source.html#l00201">putsUART</a>, <a class="el" href="_custom_s_n_t_p_8c_source.html#l00470">SNTPGetUTCSeconds()</a>, <a class="el" href="_security_system_8h_source.html#l00248">TB_SendInvalidUser</a>, <a class="el" href="_security_system_8h_source.html#l00249">TB_SendInvalidUserTimestamp</a>, <a class="el" href="x_p_l_8h_source.html#l00005">TRUE</a>, <a class="el" href="_security_system_8h_source.html#l00215">xPLConfigs::Use_AES</a>, and <a class="el" href="_security_system_8c_source.html#l00136">xPLConfig</a>.</p>

<p>Referenced by <a class="el" href="_security_system_8c_source.html#l01642">SchemaProcessUDPMsg()</a>.</p>
<div class="fragment"><pre class="fragment">                                       {
        
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AESDecodeKey[<a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>];               <span class="comment">// AES Key</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AESDecodeBlock[<a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>];             <span class="comment">// AES stuff</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> RawData[<a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a> * 2];                <span class="comment">// 10 bytes of EPOC + 16 bytes of the admin password</span>
        <span class="keywordtype">char</span> UserPassword[17];                                                  <span class="comment">// The password supplied, if AES enabled this is taken out of the decrypted data</span>
        <span class="keywordtype">int</span> ByteCopy, BlockNumber;
        DWORD MessageEPOC;                                                              <span class="comment">// EPOC (time) contained in the message is AES is enabled</span>
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;xPL message user authentication has started.\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <span class="keywordflow">if</span> (<a class="code" href="_security_system_8c.html#adaa5e54872217e9a75a2bfdadf293d12" title="Configuration entries.">xPLConfig</a>.<a class="code" href="structx_p_l_configs.html#aece9a02d06221a468e469a45e371be01" title="Use AES encryption on the user feild in the xPL message.">Use_AES</a> == <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
                <span class="comment">// AES is not enabled</span>
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; AES is disables, no encryption on user feild\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                
                <span class="keywordflow">if</span> (<a class="code" href="_authenticate_8c.html#accacf14baedf98bbdcea140a8f3cd3eb">Authenticate</a>(Password) == <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
                        <a class="code" href="_security_system_8h.html#a30c3c9cdda2491c17d5d6d5cc6426b31">addxPLMessage</a> (<a class="code" href="_security_system_8h.html#a0a181dc5b89b91c60e4db10971c38deba7cdac24e07915d54c69862bc686dbc3c">TB_SendInvalidUser</a>);
                        <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
                }
                <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;                            
        }
        
    <span class="comment">// Load admin password</span>
    memset(AESDecodeKey, <span class="charliteral">&#39;\0&#39;</span>,  <span class="keyword">sizeof</span>(AESDecodeBlock));
    <a class="code" href="_authenticate_8c.html#ae2103408fea706307404b433f103eb56">LoadUserPasswordEEdata</a> ((BYTE *) AESDecodeKey, 0, <a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>, 0);
    
    <span class="comment">// if password is less then 16, padd it out with spaces</span>
    <span class="keywordflow">while</span> (strlen(AESDecodeKey) &lt; <a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>)
            strcatpgm2ram(AESDecodeKey, (rom <span class="keywordtype">char</span> *) <span class="stringliteral">&quot; &quot;</span>);
    
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(AESDecodeKey);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; &lt;-16 byte Password for decryption\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <span class="comment">// calculate the decode key</span>
        <a class="code" href="_a_e_s_8c.html#a7cc41315b74814b03832fc37ffc835ce">AESCalcDecodeKey</a>(*AESDecodeKey); 
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(AESDecodeKey);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; &lt;-16 byte decryption key after AEScalcDecodeKey\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <span class="comment">// Decode the message and convert it back to pain text</span>
        
        BlockNumber = 0;
        memset(RawData, <span class="charliteral">&#39;\0&#39;</span>,<span class="keyword">sizeof</span>(RawData));  
        <span class="keywordflow">while</span> ((BlockNumber * <a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>) &lt; <span class="keyword">sizeof</span>(RawData)) {
                memset(AESDecodeBlock, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(AESDecodeBlock));
                <span class="keywordflow">for</span> (ByteCopy = 0; ByteCopy &lt; <a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>; ByteCopy++) {
                        AESDecodeBlock[ByteCopy] = Password[ (BlockNumber * <a class="code" href="_authenticate_8c.html#a04cbe46ec8c2a3acc05ba721f005f62c">AESBLOCKSIZE</a>) + ByteCopy];
                        <span class="keywordflow">if</span> (AESDecodeBlock[ByteCopy] == <span class="stringliteral">&#39;/0&#39;</span>) {
                                BlockNumber = 9; <span class="comment">// we have found the end of the data</span>
                                <span class="keywordflow">break</span>;
                        }       
                }       
                
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(AESDecodeBlock);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; &lt;-16 byte Block 2 be decoded\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                
                <a class="code" href="_a_e_s_8c.html#a7f4a8c317d988a237650447bd91ea792">AESDecode</a>(*AESDecodeBlock, *AESDecodeKey);
                
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(AESDecodeBlock);
                <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; &lt;-16 byte result from decode\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                
                strcat(RawData, AESDecodeBlock);
                BlockNumber++;
        }       
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(RawData);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; &lt;-Decrypted output\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
<span class="preprocessor">#if defined(STACK_USE_SNTP_CLIENT)</span>
<span class="preprocessor"></span>        
        <span class="comment">// Determine the time difference between this messgae and the system time.</span>
        <span class="comment">// AESDecodeKey is now going to be used as a temp string        </span>
        memset(AESDecodeKey, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(AESDecodeKey));
        memcpy(AESDecodeKey, RawData, 10); <span class="comment">// 10 character EPOC</span>
        MessageEPOC = atoi(AESDecodeKey);
        
        <span class="keywordflow">if</span> (<a class="code" href="_custom_s_n_t_p_8c.html#a3a2bcda2ac33aacd49d652a93f9031b1">SNTPGetUTCSeconds</a>() &gt; MessageEPOC) {
                <span class="keywordflow">if</span> ((<a class="code" href="_custom_s_n_t_p_8c.html#a3a2bcda2ac33aacd49d652a93f9031b1">SNTPGetUTCSeconds</a>() - MessageEPOC) &gt; <a class="code" href="_authenticate_8c.html#a85c957755e126e87ba42b9536489a44c">MAXTIMEDIFFERENCE</a>) {
                        <span class="comment">// Time stamp is to old</span>
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Time stamp is to old, message rejected\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        
                        <span class="comment">// Send xPL message that there was an error with the time stamp</span>
                        <a class="code" href="_security_system_8h.html#a30c3c9cdda2491c17d5d6d5cc6426b31">addxPLMessage</a> (<a class="code" href="_security_system_8h.html#a0a181dc5b89b91c60e4db10971c38deba151bd1b8f717cac517f3bc2150ef004e">TB_SendInvalidUserTimestamp</a>);
                        <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
                }
        }
        <span class="keywordflow">else</span> {
                <span class="keywordflow">if</span> ((MessageEPOC - <a class="code" href="_custom_s_n_t_p_8c.html#a3a2bcda2ac33aacd49d652a93f9031b1">SNTPGetUTCSeconds</a>()) &gt; <a class="code" href="_authenticate_8c.html#a85c957755e126e87ba42b9536489a44c">MAXTIMEDIFFERENCE</a>) {
                        <span class="comment">// Time stamp is to far in the future</span>
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>                        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Time stamp is to far in the future, message rejected\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        
                        <span class="comment">// Send xPL message that there was an error with the time stamp</span>
                        <a class="code" href="_security_system_8h.html#a30c3c9cdda2491c17d5d6d5cc6426b31">addxPLMessage</a> (<a class="code" href="_security_system_8h.html#a0a181dc5b89b91c60e4db10971c38deba151bd1b8f717cac517f3bc2150ef004e">TB_SendInvalidUserTimestamp</a>);
                        <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;           
                }
        }
        
<span class="preprocessor">#endif //#if defined(STACK_USE_SNTP_CLIENT)</span>
<span class="preprocessor"></span>
        
        <span class="comment">// Lastly we check to see if the password is valid</span>
        memset(UserPassword, <span class="charliteral">&#39;\0&#39;</span>,<span class="keyword">sizeof</span>(UserPassword));
        <span class="keywordflow">for</span> (<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>=0; (<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>+10 &lt; <span class="keyword">sizeof</span>(RawData) &amp;&amp; RawData[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>+10] != <span class="charliteral">&#39;\0&#39;</span>); <a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>++) {
                UserPassword[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a>] = RawData[<a class="code" href="_security_system_8c.html#a45c8f1ff198e164451795c949f64747a" title="Counters that are used in a number of places, centraly defined to reduce memory use.">iCount</a> + 10];
        }<span class="comment">// for </span>
        
<span class="preprocessor">#if defined(DEBUG_UART)</span>
<span class="preprocessor"></span>        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot; Decrypted password is:&quot;</span>);
        <a class="code" href="_hardware_profile_8h.html#a83f63fc3181f38af4c937906f34341c8">putsUART</a>(UserPassword);
        <a class="code" href="_hardware_profile_8h.html#afa49df8d2ce2ae222717e01eb8ed070e">putrsUART</a>((ROM <span class="keywordtype">char</span>*)<span class="stringliteral">&quot;, passing to authentication module\r\n&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <span class="keywordflow">if</span> (<a class="code" href="_authenticate_8c.html#accacf14baedf98bbdcea140a8f3cd3eb">Authenticate</a>(UserPassword) == <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
                <a class="code" href="_security_system_8h.html#a30c3c9cdda2491c17d5d6d5cc6426b31">addxPLMessage</a> (<a class="code" href="_security_system_8h.html#a0a181dc5b89b91c60e4db10971c38deba7cdac24e07915d54c69862bc686dbc3c">TB_SendInvalidUser</a>);
                <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
        }
        
        <span class="keywordflow">return</span> <a class="code" href="x_p_l_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;                            
        
        
}<span class="comment">//xPLAuthenticate</span>
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a207b19b2185ffaa19d1d3f053b996121_cgraph.svg" width="910" height="443" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe src="_authenticate_8c_a207b19b2185ffaa19d1d3f053b996121_icgraph.svg" width="1184" height="59" frameborder="0" scrolling="no"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a3b83b71efc87ba66b8d8311363b4296e"></a><!-- doxytag: member="Authenticate.c::RejectedPassword" ref="a3b83b71efc87ba66b8d8311363b4296e" args="[USERPASSLENGTH]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="_security_system_8h.html#a3b83b71efc87ba66b8d8311363b4296e">RejectedPassword</a>[USERPASSLENGTH]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tracks that last password that was rejected, useful when adding RFID tags. </p>
<p>D E C L A R A T I O N S </p>

<p>Definition at line <a class="el" href="_authenticate_8c_source.html#l00017">17</a> of file <a class="el" href="_authenticate_8c_source.html">Authenticate.c</a>.</p>

<p>Referenced by <a class="el" href="_authenticate_8c_source.html#l00246">HTTPPrint_RejectPassword()</a>, and <a class="el" href="_security_system_8c_source.html#l00193">SchemaInit()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Apr 25 2011 23:31:09 for Alarm Cabinent by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
